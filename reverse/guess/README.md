# Угадайка

## Category
Reverse

## Description
Rust постепенно захватывает Linux, поэтому не будет лишним в нём попрактиковаться.

## Level
Medium

## Cost
200

## Files
prog

## Hosting
N

## Flag
flag_plug

## Solution
Ох, это будет тяжело.
Частично - `check.py`. Там есть две секции: то как составляется флаг, и то как происходит подбор загаданного значения.
Но как решение:<br> 1. Используем `readelf -Ws prog | awk '{print $8}' | rustfilt` для просмотра имён функций. Видим странные<br>
```
prog::get_flag
prog::simple_hash
prog::log_reg
prog::gamble
```
2. Смотрим настоящие имена без rustfilt и работаем с бинариком через gdb. Устанавливаем брейкпоинты и видим, что log_reg - вход в систему, get_flag - даёт флаг, simple_hash - просто суммирует ascii коды букв в строке, и по ним выдаёт букву из алфавита `[a-zA-Z0-9]`, gamble - игра.

*Два варианта развития:*
3. Узнаём строки, которые формируют каждую букву, и получаем флаг так. (реверс функции get_flag и simple_hash)
4. Реверсим gamble и понимаем какие значения нужно говорить, чтобы гарантом узнать загаданное число. Ставим брейкпоинт на return функции log_reg, запускаем, меняем rax на 1 (или пытаемя создать пароль) и потихоньку выигрываем. (ревверс log_reg и gamble)
